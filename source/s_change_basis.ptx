<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="s_change_basis" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Change of basis</title>
<subsection xml:id="ss_change_basis_matrix">
    <title>Change of basis matrix</title>
    <definition xml:id="d_change_basis_matrix">
    <title>Change of basis matrix</title>
    <statement>
    <p>
       Let <m>B=(v_{1}, v_{2}, \dots, v_{n})</m> and <m>B'</m> be bases for the vector space <m>V</m>.
The change of basis from <m>B</m> to <m>B'</m> is the <m>n\times n</m> matrix <m>\underset{B\rightarrow B'}{P}</m> defined as
<men xml:id="eq_change_basis_matrix">
    \underset{B\rightarrow B'}{P}= \begin{bmatrix}\vert \amp \vert \amp \amp \vert \\ \phantom{v}[v_{1}]_{B'}\amp \phantom{v}[v_{2}]_{B'}\amp \dots \amp \phantom{v}[v_{n}]_{B}\\ \vert \amp \vert \amp \amp \vert\end{bmatrix}
</men>.
In other words, the <m>j</m>-th column of <m>\underset{B\rightarrow B'}{P}</m> is obtained by computing the coordinate vector of the <m>j</m>-th element of the original basis <m>B</m> with respect to the new basis <m>B'</m>.
    </p>
    </statement>
    </definition>

<theorem xml:id="th_change_basis_props">
<title>Change of basis matrix</title>
<statement>
<p>
    Let <m>B</m> and <m>B'</m> be two ordered bases of the finite-dimensional vector space <m>V</m>.
<ol>
    <li>
        <p>
            <m>\underset{B\rightarrow B'}{P}=[I_{V}]_{B}^{B'}</m>.
        </p>
    </li>

    <li>
        <p>
            For all <m>v\in V</m> we have
        <men xml:id="eq_change_basis_prop">
           \underset{B\rightarrow B'}{P}[v]_{B}=[v]_{B'}
        </men>
    In other words, to convert the <m>B</m>-coordinates of a vector <m>v\in V</m> to <m>B'</m>-coordinates, simply multiply on the left by the matrix <m>\underset{B\rightarrow B'}{P}</m>.
        </p>
    </li>
    <li>
        <p>
            The matrix <m>\underset{B\rightarrow B'}{P}</m> is the unique matrix satisfying <xref ref="eq_change_basis_prop"/>: i.e., if <m>A[v]_{B}=[v]_{B'}</m> for all <m>v\in V</m>, then <m>A=\underset{B\rightarrow B'}{P}</m>.
        </p>
    </li>
</ol>
</p>
</statement>
<proof>
    <p>
        <ol>
      <li>
        <p>
          Let <m>B=(v_1, v_2,\dots, v_n)</m>. From formula <xref ref="eq_matrixrep_formula"/> applied to <m>I_v</m>, we see that the <m>j</m>-th column of <m>[I_V]_B^{B'}</m> is 
          <me>
            [v_j]_{B'}
          </me>
          for all <m>1\leq j\leq n</m>. Using formula <xref ref="eq_change_basis_matrix"/> from <xref ref="d_change_basis_matrix"/> this is precisely the <m>j</m>-th column of <m>\underset{B\rightarrow B'}{P}</m> for all <m>1\leq j\leq n</m>. We conclude that 
          <me>
          [I_V]_B^{B'} = \underset{B\rightarrow B'}{P}
          </me>.
        </p>
      </li>
      <li>
        <p>
          This follows from (1) and <xref ref="th_matrixrep"/>:
          <md>
            <mrow> \underset{B\rightarrow B'}{P}[v]_B \amp = [\id_V]_{B}^{B'}[v]_B </mrow>
            <mrow>  \amp = [\id_V(v)]_{B'} \amp (<xref ref="th_matrixrep"/>)</mrow>
            <mrow> \amp =[v]_{B'} </mrow>
          </md>.
        </p>
      </li>
      <li>
        <p>
          By (2) of <xref ref="th_matrixrep"/> (the uniqueness claim), if <m>A</m> satisfies <m>A[v]_B=[v]_{B'}</m> for all <m>v\in \R^n</m>, then <m>A=[\id_V]_{B}^{B'}</m>. Since <m>[\id_V]_{B}^{B'}=\underset{B\rightarrow B'}{P}</m>, we conclude <m>A=\underset{B\rightarrow B'}{P}</m>.
        </p>
      </li>
    </ol>
</p>
  </proof>
</theorem>
<example xml:id="eg_changebasis_standard">
    <title><m>V=F^n</m>, <m>B</m> standard basis</title>
    <statement>
      <p>
        Consider the special situation where <m>V=F^n</m>,
        <m>B</m> is the standard basis,
        and <m>B'=\{v_1,\dots,v_n\}</m> is some nonstandard basis.
        In this case we have
      <md>
        <mrow> \underset{B'\rightarrow B}{P}\amp =\begin{bmatrix}\vert\amp\vert\amp  \amp \vert \\ [v_1]_B\amp [v_2]_B \amp \cdots\amp [v_n]_B\\ \vert\amp \vert\amp  \amp \vert \end{bmatrix}
        </mrow>
        <mrow>  \amp = \begin{bmatrix}\vert\amp\vert\amp  \amp \vert \\ v_1\amp v_2\amp\cdots\amp v_n\\ \vert\amp \vert\amp  \amp \vert \end{bmatrix} \amp (B \text{ standard basis})</mrow>
      </md>.
      In other words, <m>\underset{B'\rightarrow B}{P}</m> is the matrix whose <m>j</m>-th column is just the <m>j</m>-th element of <m>B'</m>. Thus, in this situation we can compute <m>\underset{B'\rightarrow B}{P}</m> by placing the elements of <m>B'</m> as columns of a matrix, and then use (2) of <xref ref="th_change_basis_props"/> to compute <m>\underset{B\rightarrow B'}{P}=\left(\underset{B'\rightarrow B}{P}\right)^{-1}</m>.
      </p>
    </statement>
  </example>
  
  <example>
    <title>Change of basis, <m>B</m> standard</title>
    
    
    <statement>
      <p>
        Let <m>V=\R^2</m>, <m>B=((1,0),(0,1))</m>, <m>B'=\{(1,\sqrt{3}),(-\sqrt{3},1)\}</m>. Compute <m>\underset{B\rightarrow B'}{P}</m> and <m>\underset{B'\rightarrow B}{P}</m>.
      </p>
    </statement>
    <solution>
      <p>
        According to <xref ref="eg_changebasis_standard"/> we have
        <me>\underset{B'\rightarrow B}{P}=\begin{bmatrix}1\amp -\sqrt{3}\\ \sqrt{3}\amp 1 \end{bmatrix}</me>. We then compute
        <me>
        \underset{B\rightarrow B'}{P}=(\underset{B'\rightarrow B}{P})^{-1}=\left(\begin{bmatrix}1\amp -\sqrt{3}\\ \sqrt{3}\amp 1 \end{bmatrix} \right)^{-1}=\frac{1}{4}\begin{bmatrix}1\amp \sqrt{3}\\ -\sqrt{3}\amp 1 \end{bmatrix}
        </me>.
      </p>
    </solution>
  </example>
  <remark xml:id="rm_changebasis_standard">
  <title><m>B</m> standard basis of <m>V</m></title>
      <p>
        The observation from <xref ref="eg_changebasis_standard"/> applies more generally when <m>B</m> is the standard basis of the given vector space <m>V</m> and <m>B'=(v_1, v_2, \dots, v_n)</m> is nonstandard. In this case computing <m>\underset{B'\rightarrow B}{P}</m> will be easy as the coordinate vectors <m>[v_j]_{B}</m> can be produced by inspection. See <xref ref="eg_changebasis_standard_mat"/>.
      </p>
  </remark>
  <example xml:id="eg_changebasis_standard_mat">
    <title>Change of basis, <m>B</m> standard</title>
    <statement>
      <p>
        Let <m>V=M_{22}</m>, <m>B=(E_{11}, E_{12}, E_{21}, E_{22})</m> (standard basis) and <m>B'=(A_1,A_2,A_3,A_4)</m>, where
        <me>
          A_1=\begin{amatrix}[rr]
            1\amp 1\\ 1\amp 1
        \end{amatrix}, A_2=\begin{amatrix}[rr]
          1\amp -1\\ 1\amp -1
      \end{amatrix}, A_3=\begin{amatrix}[rr]
        1\amp 1\\ -1\amp -1
    \end{amatrix}, A_4=\begin{amatrix}[rr]
      -1\amp 1\\ 1\amp -1
  \end{amatrix}
    </me>.
      Compute <m>\underset{B'\rightarrow B}{P}</m>.
      </p>
    </statement>
    <solution>
      <p>
        We have
        <md>
          <mrow> \underset{B'\rightarrow B}{P}\amp = \begin{bmatrix}
            \vert\amp \vert\amp \vert\amp \vert\\
            [A_1]_{B}\amp [A_2]_B\amp [A_3]_B\amp [A_4]_B\\
            \vert\amp \vert\amp \vert\amp \vert
          \end{bmatrix}</mrow>
          <mrow> \amp = \begin{amatrix}[rrrr]
            1\amp 1\amp 1\amp -1\\
            1\amp -1\amp 1\amp 1\\
            1\amp 1\amp -1\amp 1\\
            1\amp -1\amp -1\amp -1
          \end{amatrix} </mrow>
        </md>.
        Here the coordinate vectors <m>[A_i]_B</m> are easily computed by inspection since <m>B</m> is the standard basis. It then follows that 
        <md>
            <mrow> \underset{B\rightarrow B'}{P}\amp=(\underset{B'\rightarrow B}{P})^{-1}\amp </mrow>
            <mrow> \amp = \frac{1}{4}
                \begin{amatrix}[rrrr]
                  1\amp 1\amp 1\amp 1\\
                  1\amp -1\amp 1\amp -1\\
                  1\amp 1\amp -1\amp -1\\
                  -1\amp -1\amp 1\amp -1
                \end{amatrix}
            </mrow>
        </md>,
        where we've skipped the steps for computing the inverse matrix.  As an aside, it turn out that there is an easy way to compute the matrix in this case due to the convenient fact that the columns <m>\boldc_j</m> of <m>\underset{B'\rightarrow B}{P}</m> satisfy
        <me>
          \boldc_i\cdot\boldc_j=\begin{cases} 4\amp \text{if } i=j\\ 0\amp \text{if } i\ne j
        \end{cases}
        </me>.
        We can say more about this when we discuss inner product spaces. 
      </p>
    </solution>
  </example>
  <example>
    <title>Taylor's formula for polynomials</title>
    <statement>
      <p>
        Let <m>V=P_2(\R)</m>, <m>B=(1,x,x^2)</m>, and <m>B'=(1,(x-2),(x-2)^2)</m>.
      <ol>
        <li>
            <p>
                Prove that <m>B'</m> is a basis. 
            </p>
        </li>
        <li>
          <p>
            Compute <m>\underset{B\rightarrow B'}{P}</m>.
          </p>
        </li>
        <li>
          <p>
            Compute <m>[x^2+x+1]_{B'}</m> using <xref ref="eq_change_basis_prop"/>.
          </p>
        </li>
      </ol>
    </p>
    </statement>
    <solution>
      <p>
        <ol>
            <li>
                <p>
                    As we have seen in homework, any tuple of polynomials with distinct degrees is linearly independent. Thus <m>B'</m> is linearly independent. Since <m>\len B'=3=\dim P_2(\R)</m>, it is a basis. Street smarts! 
                </p>
            </li>
          <li>
            <p>
              We have
              <md>
                <mrow>\underset{B\rightarrow B'}{P} \amp = \begin{bmatrix}
                  \vert \amp \vert \amp \vert \\
                  [1]_{B'}\amp [x]_{B'}\amp [x^2]_{B'} \\
                  \vert \amp \vert \amp \vert
                \end{bmatrix} </mrow>
                <mrow> \amp = \begin{bmatrix}
                  0\amp 0\amp 1 \\
                  0\amp 1\amp 4\\
                  1\amp 2\amp 4
                \end{bmatrix} </mrow>
              </md>.
              The first two coordinate vector computations are nontrivial; you can verify for yourself that <m>x^2=4+4(x-2)+(x-2)^2</m> and  <m>x=2+(x-2)+0(x-2)^2</m>. Alternatively, see  <xref ref="rm_change_of_basis_taylors"/>) for a neat trick for computing these coordinate vectors.
            </p>
          </li>
          <li>
            <p>
              Since <m>B</m> is the standard basis, we see easily that <m>[x^2+x+1]_{B}=(1,1,1)</m>. Using <xref ref="eq_change_basis_prop"/> we have
              <md>
                <mrow>[x^2+x+1]_{B'} \amp = \underset{B\rightarrow B'}{P}\begin{bmatrix}
                  1\\ 1\\ 1
                \end{bmatrix}</mrow>
                <mrow> \amp =\begin{bmatrix}
                  7\\ 5\\ 1
                \end{bmatrix} </mrow>
              </md>.
              Verify for yourself that we do indeed have
              <me>
                x^2+x+1=7+5(x-2)+(x-2)^2
              </me>.
            </p>
          </li>
        </ol>
      </p>
    </solution>
  </example>
      <remark xml:id="rm_change_of_basis_taylors">
    <title>Taylor's formula and change of basis</title>
    <p>
      Let <m>B=(1,x,\dots, x^n)</m> be the standard basis of <m>P_n</m>. Fix any constant <m>a\in \R</m>, and let <m>B'=(1,(x-a),\dots, (x-a)^n)</m>. Since the elements of <m>B'</m> have distinct degrees, <m>B'</m> is linearly independent, and hence a basis (since it has the right length). It follows from Taylor's theorem (from single-variable calculus) that given any polynomial <m>p\in P_n(\R)</m> we have
      <me>
        p(x)=p(a)+p'(a)(x-a)+\frac{p''(x)}{2}(x-a)^2+\cdots \frac{p^{(n)}(a)}{n!}(x-a)^n
      </me>.
      We call this expression the expansion of <m>p(x)</m> about <m>x=a</m>. In terms of coordinate vectors, this means that
      <men xml:id="eq_taylors">
        [p]_{B'}=\left(p(a),p'(a),\frac{p''(a)}{2},\dots, \frac{p^{(n)}(a)}{n!}\right)
      </men>.
      In other words, Taylor's theorem provides a simple derivative formula for computing coordinate vectors with respect to the basis <m>B'</m>.
    </p>
  </remark>
  <p>
    Before connecting change of basis matrices with matrix representations of linear transformations, it is worth gathering some of the different techniques for computing change of basis matrices we have discussed so far.
  </p>
  <algorithm xml:id="proc_changebasis_tips">
  <title>Change of basis computational tips</title>
    <statement>
      <p>
        Let <m>B=(v_1, v_2, \dots, v_n)</m> and <m>B'</m> be ordered bases of the vector space <m>V</m>. Below you find a variety of techniques for computing <m>\underset{B\rightarrow B'}{P}</m> and <m>\underset{B'\rightarrow B}{P}</m>.
      
      <ol>
        <li>
          <p>
            To compute <m>\underset{B\rightarrow B'}{P}</m> directly, we must compute <m>[v_j]_{B'}</m> for each <m>1\leq j\leq n</m>. This typically involves setting up and solving a linear system.
          </p>
        </li>
        <li>
          <p>
            We have <m>\underset{B'\rightarrow B}{P}=(\underset{B\rightarrow B'}{P})^{-1}</m>. This observation is useful in situations where (a) one change of basis matrix is easier to compute than the other and (b) computing inverse matrices is not too onerous.
          </p>
        </li>
        <li>
          <p>
            If <m>B</m> is the standard basis of <m>V</m>, then <m>\underset{B'\rightarrow B}{P}</m> is easy to compute. (See <xref ref="rm_changebasis_standard"/>.)
          </p>
        </li>
      </ol>
    </p>
    </statement>
  </algorithm>
</subsection>

</section>